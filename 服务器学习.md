
### ssh 无密码登陆到其他环境的服务器
>1 vim .ssh/config   

```
 host zxl(自己定义的名字)
   hostname ip
   user name(你需要登陆的环境的名字)
```
>2  cat ~/.id_rsa.pub   
>3  vim ~/.ssh/authorized_keys 粘贴上即可  
总结:将公钥copy 到 authorized_keys，需要配置config  
#### linux一些习惯
>1 要编译的源文件一般放在/usr/local/src (source)  
>2 编译后的代码放在/usr/local/

#### make
```
./configure makeclean make nakeinstall 
```
> 1.  fdisk -l  查看自己的数据盘大小。启动稳定性。把数据放在数据盘上，即使换了一个linux系统盘清除，数据也不会丢失
> 2.  df -h   硬盘的使用情况 
```
Filesystem      Size  Used Avail Use% Mounted on
udev            484M  4.0K  484M   1% /dev
tmpfs           100M  412K   99M   1% /run
/dev/vda1        40G  2.0G   36G   6% / 
```
> 3.  每次ssh root(用户名)@ip 太麻烦 在本机设置一下~.zshrc配置
  ```
  1.alias ssh_cd="root@ip"     
  2.source .zshrc  
  3 ssh_cd  
 ```
>1.df -h  
>2. 每次ssh root(用户名)@ip 太麻烦 在本机设置一下~.zshrc配置
  ```
  >1.alias ssh_cd="root@ip"     
  >2.source .zshrc  
  >3 ssh_cd  
 ```
>3 adduser xxx
 ```
 Adding user `icd_manager' ...
Adding new group `icd_manager' (1000) ...
Adding new user `icd_manager' (1000) with group `icd_manager' ...
Creating home directory `/home/icd_manager' ...
Copying files from `/etc/skel' ...
 ```
>4 gpasswd -a icd_manager sudo     添加用户到组 权利升级
```
Adding user icd_manager to group sudo
```

>5 sudo
用来以其他身份来执行命令，预设的身份为root。在/etc/sudoers中设置了可执行sudo指令的用户。若其未经授权的用户企图使用sudo，则会发出警告的邮件给管理员。用户使用sudo时，必须先输入密码，之后有5分钟的有效期限，超过期限则必须重新输入密码。
sudo visudo
```
root    ALL=(ALL:ALL) ALL
icd_manager ALL=(ALL:ALL) ALL 可以像root
```
这样其他用户就可以等登陆了 通过远程的计算机

ssh无密码登陆
```
ssh-keygen -t rsa -b 4096  -C “yangchongduo@gmail.com.... 生成公钥 和 私钥
ssh-keygen -t rsa -C “yangchongduo@gmail.com”
id_rsa.pub  公钥 要放在gitlab上这样就有权限push仓库了
id_rsa 私钥 
然后在设置代理 这个以后再做
vi ~/.ssh/authorized_keys
将本地电脑的公钥放在服务器上authorized_keys 这个文件中，让服务器持有公钥
chmod 600 authorized_keys 修改authorized_keys权限
sudo service ssh restart 让ssh服务重启 如果使用sudo 就是让用户在一定时间内有root的权限 
这样就不需要输入密码的
```
vi shift + : + wq!
安装node环境
```
sudo apt-get update ?
sudo apt-get install vim  openssl build-essential libssl-dev wget(下载工具) curl git（部署） 
node
nvm alias default v6.10.3
```
>1sudo su icd_manager  暂时获取谁的权限 来进行操作  因为一个系统有很多用户组


>2外网全部达到nginx上通过nginx：80 端口，然后通过接续到不同的应用的端口，同时还是分发到不同的机器上，所以才能起到负载均衡的特点。
外网统一是访问port:80 
```
/etc/nginx/conf.d/xxx-vvv-8888.conf // 这样就可以很清楚的知道这个配置文件对应 port等等
```
>3 nginx模块 
>> Upstream 模块 负载均衡的模块
>> 包含下面所有的nginx配置 
```
   include /etc/nginx/conf.d/*.conf;
   include /etc/nginx/sites-enabled/*;
```
>nginx -t 检查 各种配置文件

>1.开启mongo 数据库服务  || 关闭mongo 数据库服务
```
sudo service mongod start
sudo service mongod stop
```

#### 查看是否mongo 是否开动成功
```
> 1.cat /var/log/mongodb/mongod.log 查看数据库的日志 
> 2. mongo 查看是否能够连接成功 进入mongo的命令行 
```
mongo 
>1. sudo service mongo restart 重启
>2. mongo 默认是27017端口上 全世界都知道  
```
sudo vim /etc/mongod.conf  
net:
  port: 19999
  bindIp: 127.0.0.1
sudo service mongod restart 
mongo --port 19999
假如有防火墙的话是连不上的 需要更改防火墙的端口 以后做
```
备份数据库
```
 mongodump -h 127.0.0.1:27017 -d blog -o test   备份
 tar zcvf  xxxx.tar.gz 源文件  压缩
 scp -P(p)  文件名  icd_manager@47.94.95.52:/home/icd_manager/.....
 scp -P(p)  ./blog.tar.gz  icd_manager@47.94.95.52:/home/icd_manager/db
 tar xvf  xxxx.tar.gz 源文件  解压
 tar -xvf a.tar -C ./test/ 绝对可以的 解压到指定的文件
mongorestore --host 127.0.0.1 -d 数据库的名字   具体的数据库

cp -rf ./data/db/. ./ 
ps -aef | grep mongo 查看mongo的pid
sudo kill uid（用sudo kill才可以）；
docker run -p 27017:27017 -v $PWD/db:/data/db -d mongo
mongodump -h 127.0.0.1:27017 -d doc(数据库) -o  doc-backup(文件夹)
mongorestore --host 127.0.0.1:27017 -d doc ./doc-backup(文件件)/doc(数据库)
```
pm2部署 
>1 我们通过pm2 deploy的时候是是对文件没有权限读写的Permission denied
>sudo chmod 777 production/ 


first deploy 部署

>1. pm2 deploy ecosystem.json production setup 
>2. sudo chmod 777 www(文件夹的名字) chmod 修改对文件的读写
second 远程控制服务器服务的启动停止
>1.  pm2 deploy ecosystem.json production 
	```
	bash: pm2: command not found
   远程服务器：vim .bashrc
   #case $- in
	#    *i*) ;;
	#      *) return;;
	#esac
	```
	┌──────────┬────┬──────┬───────┬────────┬─────────┬────────┬─────┬───────────┬──────────┐
  │ App name │ id │ mode │ pid   │ status │ restart │ uptime │ cpu │ mem       │ watching │
  ├──────────┼────┼──────┼───────┼────────┼─────────┼────────┼─────┼───────────┼──────────┤
  │ CRM      │ 0  │ fork │ 11823 │ online │ 1       │ 0s     │ 46% │ 24.6 MB   │ disabled │
  │ CRM      │ 1  │ fork │ 11832 │ online │ 0       │ 0s     │ 27% │ 25.3 MB   │ disabled │
  │ CRM      │ 2  │ fork │ 11839 │ online │ 0       │ 0s     │ 23% │ 25.2 MB   │ disabled │
  └──────────┴────┴──────┴───────┴────────┴─────────┴────────┴─────┴───────────┴──────────┘


#### nginx 删除然后通过编译生成nginx
```
 which nginx 
 sudo apt-get purge nginx-*
 sudo apt-get autoremove
 dpkg --get-selections|grep nginx
罗列出与nginx相关的软件， nginx-common deinstall 然后
sudo apt-get --purge remove nginx-common
这样就可以完全卸载掉nginx包括配置文件
```
#### [将nginx升级](http://www.tuicool.com/articles/aqyMve)  
```
彻底伤删除nginx之后 which nginx 查看是否删除
下载  OpenSSL ， pcre ， Zlib 跟 Nginx源码 
重新启动
[root@admin nginx-1.2.6]# /usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf 
#方法2 
[root@admin nginx-1.2.6]# cd /usr/local/nginx/sbin 
[root@admin sbin]# ./nginx 
```





